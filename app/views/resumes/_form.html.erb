<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <h1 class="text-center mb-4">Create / Edit Resume</h1>

      <%= form_with(model: [current_user, resume], local: true, html: { class: "needs-validation" }) do |f| %>
        
        <% if resume.errors.any? %>
          <div class="alert alert-danger">
            <h4><%= pluralize(resume.errors.count, "error") %> prohibited this resume from being saved:</h4>
            <ul>
              <% resume.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="mb-3">
          <%= f.label :name, class: "form-label" %>
          <%= f.text_field :name, class: "form-control", placeholder: "Enter your full name" %>
        </div>

        <div class="mb-3">
          <%= f.label :bio, class: "form-label" %>
          <%= f.text_area :bio, class: "form-control", rows: 4, placeholder: "Write a short bio about yourself" %>
        </div>

        <div class="mb-3">
          <%= f.label :theme, class: "form-label" %>
          <%= f.select :theme, ["clean", "minimal", "dark", "neon"], { prompt: "Choose a theme" }, class: "form-select" %>
        </div>

        <h3 class="mb-3">Projects</h3>
        <div data-controller="nested-form" class="mb-3">
          <div data-nested-form-target="container" class="mb-3">
            <%= f.fields_for :projects do |p| %>
              <%= render "project_fields", f: p %>
            <% end %>
          </div>

          <template data-nested-form-target="template">
            <%= f.fields_for :projects, Project.new, child_index: "NEW_RECORD" do |p| %>
              <%= render "project_fields", f: p %>
            <% end %>
          </template>

          <button type="button" class="btn btn-outline-primary mb-3" data-action="click->nested-form#add">
            + Add Project
          </button>
        </div>
        

        <h3>Skills</h3>
        <div data-controller="nested-form" class="mb-3">
          <div data-nested-form-target="container" class="mb-3">
            <%= f.fields_for :skills do |s| %>
              <%= render "skill_fields", f:s %>
            <% end %>
          </div>

          <template data-nested-form-target="template">
            <%= f.fields_for :skills, Skill.new, child_index: "NEW_RECORD" do |s| %>
              <%= render "skill_fields", f:s %>
            <% end %>
          </template>

          <button type="button" class="btn btn-outline-primary mb-3" data-action="click->nested-form#add">
            + Add Skill
          </button>

        </div>
        <div class="d-grid">
          <%= f.submit "Save Resume", class: "btn btn-success btn-lg" %>
        </div>

      <% end %>
    </div>
  </div>
</div>
